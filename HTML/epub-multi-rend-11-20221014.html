<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"><head>
<meta charset="utf-8">
<meta name="generator" content="ReSpec 32.3.0">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
		
		
<title>EPUB 3 Multiple-Rendition Publications 1.1</title>
		
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
		
		
	
<style>

ul.nomark,
ol.nomark {
    list-style-type: none;
}

ol.cmt,
ul.flat {
	list-style-type: none;
	padding-left: 0;
}

ol.cmt {
	margin: 0;
}

dl.elemdef {
    border-left: 0.5em solid rgb(145,200,255);
    background-color: rgb(236,246,255);
    padding: 0.5em 1em;
	margin-bottom: 2em;
}

dl.elemdef ul.nomark {
	padding-left: 1em;
}

dl.elemdef > dd > ul.nomark:first-child {
	padding-left: 0 !important;
}

dl.conformance-list > dd {
    margin-top: 0.7em;
}

dl.elemdef > dt,
table.tabledef th {
	font-weight: normal;
	font-style: italic;
}

dl.elemdef > dt {
	margin-bottom: 0.5em;
}

dl.elemdef dfn {
	font-style: normal;
}

/*  EBNF tables */


table.productionset {
    border: none;
    border-left: 5px solid rgb(145,200,255);
    background-color: rgb(236,246,255);
}

table.productionset caption {
	text-align: left;
	font-size: 80%;
	font-style: normal;
}

table.productionset tbody tr {
    border: none;
}

table.productionset tbody tr td {
    border: none;
    padding: 0.5em;
    border-bottom: 1px solid #ddd;
}

table.productionset tbody tr td a {
    text-decoration: none;
    border-bottom: 1px dotted #000090;
}

table.productionset tbody tr td a:hover {
    text-decoration: underline;
}

table.productionset tbody tr td a:visited,
table.productionset tbody tr td a:active,
table.productionset tbody tr td a:hover {
    color: #000090;
}

a.deprecated,
a.legacy {
	font-size: 85%;
	text-transform: uppercase;
}

/* styles for core media types */

table#tbl-core-media-types {
    border-spacing: 0px;
    padding: 1em;
    margin-top: 1.5em;
    margin-bottom: 2em;    
}

table#tbl-core-media-types th {
    border-bottom: 1px solid #005A9C;
    font-weight: bold;
    padding: 0.5em;
    font-weight: bold;
    color: #000090;
    font-size: 90%
}

table#tbl-core-media-types td {
    border-bottom: 1px solid #005A9C;
    border-right: 1px solid #efefef;
    padding: 0.5em;
    text-align: left
}

table#tbl-core-media-types tr td:last-child {
    border-right: none;
}

table#tbl-core-media-types td *, table#tbl-core-media-types td > * {
    text-align: left;
}

table#tbl-core-media-types, table#tbl-core-media-types tbody {
    padding: 0;
}

table#tbl-core-media-types caption {
    text-align: left;
    font-size: 90%
}

.tbl-group {
	text-align: left;
	border-bottom: none;
	color: rgb(0, 0, 0);
	background-color: rgb(240, 248, 255);
}

table#tbl-core-media-types > thead > tr > th {
    background-color: rgb(240,240,240);
    text-align: left;
    white-space:nowrap;
}

table#tbl-core-media-types > tbody > tr > th {    
    text-align: left;
    font-weight: normal;
    font-style: italic;
    padding: 3px;
}

table#tbl-core-media-types td, table#tbl-core-media-types th, table#tbl-core-media-types tr {
    border-color: #005A9C;
    margin: 0em;
}

table#tbl-core-media-types td code, table#tbl-core-media-types td a {
    white-space:nowrap;
}

td[headers="tbl-cmt-appl"] {
    font-size: .9em;
}




/****************************************************/
/*  property tables                                 */
/****************************************************/

/* ensure confomity of width for property tables */
table.tabledef {
	border-spacing: 0px;
	border: none;
	font-size: 1em;
	width: 100%
}

table.tabledef td, table.tabledef th {
	border: none;
	background-color: rgb(236,246,255);
	color: rgb(0,0,0);
	padding: 0.3em;
	vertical-align: top;
}

table.tabledef th {
    text-align: left;
	vertical-align: top;
    width: 8em;
    padding-left: 1em;
}

table.tabledef th {
    border-left: 5px solid rgb(145,200,255);
}

table.tabledef td {
    padding: 3px 3px 3px 10px;
}

table.tabledef td > p:first-child {
	padding: 0em;
	margin: 0em
}


/* Reserved prefix tables */

table.prefix {
    border-spacing: 0px;
    padding: 1em;
    margin-top: 1.5em;
    margin-bottom: 2em;    
}
table.prefix th {
    border-bottom: 1px solid #005A9C;
    font-weight: bold;
    padding: 0.5em;
    font-weight: bold;
    color: #000090;
    font-size: 90%
}
table.prefix td {
    border-bottom: 1px solid #005A9C;
    border-right: 1px solid #efefef;
    padding: 0.5em;
    text-align: left
}
table.prefix tr td:last-child {
    border-right: none;
}
table.prefix td *, table.prefix td > * {
    text-align: left;
}
table.prefix, table.prefix tbody {
    padding: 0;
}

table.prefix caption {
    text-align: left;
    font-size: 90%
}


/* Table zebra style... */

table.zebra {
    font-size:inherit;
    font:90%;
    margin:1em;
}

table.zebra td {
    padding-left: 0.3em;
}

table.zebra th {
    font-weight: bold;
    text-align: center;
    background-color: rgb(0,0,128) !important;
    font-size: 110%;
    background: hsl(180, 30%, 50%);
    color: #fff;
}

table.zebra th a:link {
  color: #fff;
}

table.zebra th a:visited {
  color: #aaa;
}

table.zebra tr:nth-child(even) {
    background-color: hsl(180, 30%, 93%) !important;
}

table.zebra th{border-bottom:1px solid #bbb;padding:.2em 1em;}
table.zebra td{border-bottom:1px solid #ddd;padding:.2em 1em;}


p.support {
	border-left: 0.4rem solid rgb(255,255,0);
	background-color: rgb(255,255,230);
	padding: 0.7rem;
}

p.caution, div.caution {
	padding: 0.5rem;
	border-left: 0.5rem solid rgb(255,140,0);
	background-color: rgb(254,236,207);
}

div.caution-title > span {
	color: rgb(140,40,0);
	text-transform: uppercase;
}

details.desc {
	margin-top: -2.5rem !important;
	margin-left: 3rem !important;
}

details.explanation, details.desc {
	background-color: rgb(245,245,245);
	border-left: 0.3em solid rgb(200,200,200);
	padding: 0.3em;
}

details.explanation > summary, details.desc > summary {
	font-size: small;
	text-align: left;
    font-weight: normal !important;
    font-style: italic;
}

</style>
<meta name="description" content="This specification, EPUB Multiple-Rendition Publications, defines the creation and rendering of EPUB®
				Publications consisting of more than one rendition.">
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "group": "epub",
  "wgPublicList": "public-epub-wg",
  "specStatus": "ED",
  "shortName": "epub-multi-rend-11",
  "edDraftURI": "https://w3c.github.io/epub-specs/epub33/multi-rend/",
  "previousPublishDate": "2021-12-08",
  "previousMaturity": "NOTE",
  "copyrightStart": "2015",
  "noRecTrack": true,
  "editors": [
    {
      "name": "Matt Garrish",
      "company": "DAISY Consortium",
      "companyURL": "https://daisy.org",
      "w3cid": 51655
    }
  ],
  "formerEditors": [
    {
      "name": "Jim Lester",
      "company": "Barnes &amp; Noble"
    },
    {
      "name": "Takeshi Kanai",
      "company": "Sony Corporation",
      "companyURL": "http://www.sony.net/"
    }
  ],
  "includePermalinks": true,
  "permalinkEdge": true,
  "permalinkHide": false,
  "github": {
    "repoURL": "https://github.com/w3c/epub-specs",
    "branch": "main"
  },
  "pluralize": true,
  "localBiblio": {
    "iso24751-3": {
      "title": " ISO/IEC 24751-3:2008 Information technology -- Individualized adaptability and accessibility in e-learning, education and training -- Part 3: &quot;Access for all&quot; digital resource description",
      "href": "http://www.iso.org/iso/catalogue_detail?csnumber=43604",
      "date": "2008-10-01",
      "id": "iso24751-3"
    },
    "epubcfi-11": {
      "authors": [
        "Peter Sorotokin",
        "Garth Conboy",
        "Brady Duga",
        "John Rivlin",
        "Don Beaver",
        "Kevin Ballard",
        "Alastair Fettes",
        "Daniel Weck"
      ],
      "title": "EPUB Canonical Fragment Identifiers 1.1",
      "href": "http://idpf.org/epub/linking/cfi/epub-cfi-20170105.html",
      "date": "5 October 2017",
      "publisher": "IDPF",
      "id": "epubcfi-11"
    }
  },
  "xref": {
    "profile": "web-platform",
    "specs": [
      "epub-rs-33",
      "epub-33"
    ]
  },
  "preProcess": [
    null
  ],
  "publishISODate": "2022-10-14T00:00:00.000Z",
  "generatedSubtitle": "W3C Editor's Draft 14 October 2022"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED"></head>
	<body class="h-entry toc-inline" data-cite="epub-rs-33 epub-33 HTML INFRA URL WEBIDL DOM FETCH"><div class="head">
    <p class="logos"><a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
  </a></p>
    <h1 id="title" class="title">EPUB 3 Multiple-Rendition Publications 1.1</h1> 
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#ED">W3C Editor's Draft</a> <time class="dt-published" datetime="2022-10-14">14 October 2022</time></p>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://w3c.github.io/epub-specs/epub33/multi-rend/">https://w3c.github.io/epub-specs/epub33/multi-rend/</a>
              </dd>
        <dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/epub-multi-rend-11/">https://www.w3.org/TR/epub-multi-rend-11/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/epub-specs/epub33/multi-rend/">https://w3c.github.io/epub-specs/epub33/multi-rend/</a></dd>
        <dt>History:</dt><dd>
                    <a href="https://www.w3.org/standards/history/epub-multi-rend-11">https://www.w3.org/standards/history/epub-multi-rend-11</a>
                  </dd><dd>
                    <a href="https://github.com/w3c/epub-specs/commits/main">Commit history</a>
                  </dd>
        
        
        
        
        
        <dt>Editor:</dt><dd class="editor p-author h-card vcard" data-editor-id="51655">
    <span class="p-name fn">Matt Garrish</span> (<a class="p-org org h-org" href="https://daisy.org">DAISY Consortium</a>)
  </dd>
        <dt>
                Former editors:
              </dt><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Jim Lester</span> (<span class="p-org org h-org">Barnes &amp; Noble</span>)
  </dd><dd class="editor p-author h-card vcard">
    <span class="p-name fn">Takeshi Kanai</span> (<a class="p-org org h-org" href="http://www.sony.net/">Sony Corporation</a>)
  </dd>
        
        <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c/epub-specs/">GitHub w3c/epub-specs</a>
        (<a href="https://github.com/w3c/epub-specs/pulls/">pull requests</a>,
        <a href="https://github.com/w3c/epub-specs/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c/epub-specs/issues/">open issues</a>)
      </dd><dd><a href="mailto:public-epub-wg@w3.org?subject=%5Bepub-multi-rend-11%5D%20YOUR%20TOPIC%20HERE">public-epub-wg@w3.org</a> with subject line <kbd>[epub-multi-rend-11] <em>… message topic …</em></kbd> (<a rel="discussion" href="https://lists.w3.org/Archives/Public/public-epub-wg">archives</a>)</dd>
        
        
      </dl>
    </details>
    
    
    <p class="copyright">
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    ©
    2015-2022
    
    <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
    <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>,
    <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
    <a rel="license" href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
  </p>
    <hr title="Separator for header">
  </div>
		<section id="abstract" class="introductory"><h2>Abstract</h2>
			<p>This specification, EPUB Multiple-Rendition Publications, defines the creation and rendering of EPUB®
				Publications consisting of more than one rendition.</p>
		</section>
		<section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
      https://www.w3.org/TR/.</em></p><p>
    This document was published by the <a href="https://www.w3.org/groups/wg/epub">EPUB 3 Working Group</a> as
    an Editor's Draft. 
  </p><p>Publication as an Editor's Draft does not
  imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. </p><p>
    This is a draft document and may be updated, replaced or obsoleted by other
    documents at any time. It is inappropriate to cite this document as other
    than work in progress.
    
  </p><p>
    
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent
          Policy</a>.
      
    
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                <a rel="disclosure" href="https://www.w3.org/groups/wg/epub/ipr">public list of any patent disclosures</a>
          made in connection with the deliverables of
          the group; that page also includes
          instructions for disclosing a patent. An individual who has actual
          knowledge of a patent which the individual believes contains
          <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a>
          must disclose the information in accordance with
          <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        
  </p><p>
                  This document is governed by the
                  <a id="w3c_process_revision" href="https://www.w3.org/2021/Process-20211102/">2 November 2021 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                </p></section>
		<nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#intro"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#overview"><bdi class="secno">1.1 </bdi>Overview</a></li><li class="tocline"><a class="tocxref" href="#background"><bdi class="secno">1.2 </bdi>Background</a></li><li class="tocline"><a class="tocxref" href="#rel-epub3"><bdi class="secno">1.3 </bdi>Relationship to EPUB 3</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">1.4 </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">1.5 </bdi>Conformance</a></li></ol></li><li class="tocline"><a class="tocxref" href="#container"><bdi class="secno">2. </bdi>Specifying multiple renditions</a></li><li class="tocline"><a class="tocxref" href="#sec-metadata"><bdi class="secno">3. </bdi>Expressing metadata</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#rendition-metadata"><bdi class="secno">3.1 </bdi>Rendition metadata</a></li><li class="tocline"><a class="tocxref" href="#pub-metadata"><bdi class="secno">3.2 </bdi>Publication metadata</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#pub-metadata-file"><bdi class="secno">3.2.1 </bdi>The <code>metadata.xml</code> file</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#pub-metadata-obfuscation"><bdi class="secno">3.2.1.1 </bdi>Resource obfuscation</a></li></ol></li><li class="tocline"><a class="tocxref" href="#vocab-assoc"><bdi class="secno">3.2.2 </bdi>Vocabulary association mechanisms</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#rendition-selection"><bdi class="secno">4. </bdi>Rendition selection</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#rendition-selection-intro"><bdi class="secno">4.1 </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#rendition-selection-pub-confomance"><bdi class="secno">4.2 </bdi>Content conformance</a></li><li class="tocline"><a class="tocxref" href="#rendition-selection-rs-conformance"><bdi class="secno">4.3 </bdi>reading system conformance</a></li><li class="tocline"><a class="tocxref" href="#rendition-selection-attr"><bdi class="secno">4.4 </bdi>Rendition selection attributes</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#media-attr"><bdi class="secno">4.4.1 </bdi>The <code>rendition:media</code> attribute</a></li><li class="tocline"><a class="tocxref" href="#layout-attr"><bdi class="secno">4.4.2 </bdi>The <code>rendition:layout</code> attribute</a></li><li class="tocline"><a class="tocxref" href="#language-attr"><bdi class="secno">4.4.3 </bdi>The <code>rendition:language</code> attribute</a></li><li class="tocline"><a class="tocxref" href="#accessMode-attr"><bdi class="secno">4.4.4 </bdi>The <code>rendition:accessMode</code> attribute</a></li><li class="tocline"><a class="tocxref" href="#label-attr"><bdi class="secno">4.4.5 </bdi>The <code>rendition:label</code> attribute</a></li></ol></li><li class="tocline"><a class="tocxref" href="#rendition-selection-proc-model"><bdi class="secno">4.5 </bdi>Processing model</a></li></ol></li><li class="tocline"><a class="tocxref" href="#rendition-mapping"><bdi class="secno">5. </bdi>Rendition mapping</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#rendition-mapping-intro"><bdi class="secno">5.1 </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#rendition-mapping-pub-conformance"><bdi class="secno">5.2 </bdi>Content conformance</a></li><li class="tocline"><a class="tocxref" href="#rendition-mapping-rs-conformance"><bdi class="secno">5.3 </bdi>reading system conformance</a></li><li class="tocline"><a class="tocxref" href="#rendition-mapping-doc-def"><bdi class="secno">5.4 </bdi>EPUB rendition mapping document definition</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#rendition-mapping-doc-xhtml"><bdi class="secno">5.4.1 </bdi>XHTML content document: restrictions</a></li><li class="tocline"><a class="tocxref" href="#rendition-mapping-doc-nav"><bdi class="secno">5.4.2 </bdi>The nav element: modifications and restrictions</a></li><li class="tocline"><a class="tocxref" href="#rendition-mappings"><bdi class="secno">5.4.3 </bdi>Rendition mappings</a></li><li class="tocline"><a class="tocxref" href="#rendition-mapping-container-id"><bdi class="secno">5.4.4 </bdi>Container identification</a></li></ol></li><li class="tocline"><a class="tocxref" href="#rendition-mapping-proc-model"><bdi class="secno">5.5 </bdi>Processing model</a></li></ol></li><li class="tocline"><a class="tocxref" href="#app-schemas"><bdi class="secno">A. </bdi>Schemas</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#schema-metadata"><bdi class="secno">A.1 </bdi>Metadata.xml Schema</a></li><li class="tocline"><a class="tocxref" href="#schema-container"><bdi class="secno">A.2 </bdi>Container.xml schema</a></li><li class="tocline"><a class="tocxref" href="#schema-mapping-doc"><bdi class="secno">A.3 </bdi>Mapping document schema</a></li></ol></li><li class="tocline"><a class="tocxref" href="#change-log"><bdi class="secno">B. </bdi>Change log</a></li><li class="tocline"><a class="tocxref" href="#ack"><bdi class="secno">C. </bdi>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">D. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">D.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">D.2 </bdi>Informative references</a></li></ol></li></ol></nav>
		<section id="intro"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#intro" aria-label="Permalink for Section 1."></a></div>
			

			<section id="overview" class="informative"><div class="header-wrapper"><h3 id="x1-1-overview"><bdi class="secno">1.1 </bdi>Overview</h3><a class="self-link" href="#overview" aria-label="Permalink for Section 1.1"></a></div><p><em>This section is non-normative.</em></p>
				

				<p>The need to include more than one <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-1">rendition</a> of an <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-publication">EPUB publication</a> has grown as <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-reading-system">reading systems</a> have evolved and become more sophisticated. While some measure of content adaptation has
					always been possible at the style sheet level, it is both limited in what it can accomplish and
					limited to content rendering. Existing fallback mechanisms within the <a data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-package-document">package document</a>
					similarly only ensure that resources can be rendered.</p>

				<p>Adaptation is not just about optimizing styling and positioning content for screen considerations,
					such as dimensions and color or reading system orientation, but often involves changing the content
					itself. The resources and markup required to render a fixed-layout rendition of an EPUB publication
					may overlap with a reflowable version of the same, but the two are never exactly the same.
					Adaptation also involves adapting the prose of a work. In an increasingly interconnected world,
					including multiple translations of a work rather than bundling them all separately as
					single-language EPUB publications is often a necessity. And adaptation is also about the ability to
					move from the same spot in one rendition to the equivalent spot in another as changes in the reading
					environment occur.</p>

				<p>This specification defines how a reading system selects from multiple <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-creator">EPUB creator</a>-provided
					renditions of the content to best match the current device characteristics and user preferences
					— it does not define methods for modifying content on the fly. As changes occur to device
					orientation or the user's preferred reading modality, for example, the reading system will be able
					to check for a better rendition and seamlessly present it using the functionality defined
					herein.</p>

				<p>The specification addresses each of the major requirements in the discovery of, selection of, and
					mapping between, multiple renditions of an EPUB publication. In particular:</p>

				<ul>
					<li>the establishment of a unique identifier common to all the renditions in the
							<code>META-INF/metadata.xml</code> file;</li>
					<li>the selection of renditions through a set of attributes that can be attached to
							<code>rootfile</code> elements in the <a data-link-type="dfn" href="#dfn-container-document" class="internalDFN" id="ref-for-dfn-container-document-1">container document</a>;</li>
					<li>the optional ability to move from a point in one rendition to the same location in another by
						means of a mapping document.</li>
				</ul>

				<p>Taken together, these features enable the creation of advanced multiple-rendition publications that
					reading systems can adapt to changing user needs.</p>
			</section>

			<section id="background" class="informative"><div class="header-wrapper"><h3 id="x1-2-background"><bdi class="secno">1.2 </bdi>Background</h3><a class="self-link" href="#background" aria-label="Permalink for Section 1.2"></a></div><p><em>This section is non-normative.</em></p>
				

				<p>The notion of including multiple renditions of an <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-publication">EPUB publication</a> has existed for as long as the
					EPUB standard, but the specification has never fully addressed what these renditions are for and how
					to access them. As a result, the EPUB 3 specification generally equates an EPUB publication with a
					single rendering of the content. Moreover, most <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-creator">EPUB creators</a> and <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-reading-system">reading system</a> developers
					equate an EPUB publication with a single <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-package-document">package document</a> referenced from the first
						<code>rootfile</code> element in the <code>container.xml</code> file [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</p>

				<p>In practice, however, the <code>container.xml</code> file does not restrict EPUB creators to listing
					only a single package document. In EPUB 2, for example, <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-creator">EPUB creators</a> could add additional
						<code>rootfile</code> elements referencing any other format they desired (e.g., another package
					document, a PDF file, or even a Word Document). In EPUB 3, <code>rootfile</code> elements were
					restricted to referencing only package documents of the same version of the standard.</p>

				<p>This specification moves beyond merely allowing multiple renderings to define a more complete
					framework for identifying and selecting from among them. Each package document referenced from a
						<code>rootfile</code> element is defined to be one <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-2">rendition</a> of the EPUB publication, with
					the first package document representing the <a data-link-type="dfn" href="#dfn-default-rendition" class="internalDFN" id="ref-for-dfn-default-rendition-1">default rendition</a> (i.e., the one that all reading
					systems have to process).</p>

				<p>Although this model is intended to work as seamlessly as possible with existing the EPUB ecosystem,
					the authoring of multiple renditions requires some compromises to maintain compatibility (e.g., some
					duplication of metadata will be necessary for reading systems that do not handle multiple
					renditions).</p>
			</section>

			<section id="rel-epub3"><div class="header-wrapper"><h3 id="x1-3-relationship-to-epub-3"><bdi class="secno">1.3 </bdi>Relationship to EPUB 3</h3><a class="self-link" href="#rel-epub3" aria-label="Permalink for Section 1.3"></a></div>
				

				<p>The method defined in this specification for including multiple <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-3">renditions</a> within an <a data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-container">EPUB
						container</a> is not required for all <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-publication">EPUB publications</a>. Multiple renditions <em class="rfc2119">MAY</em> be included
					in a container without adhering to this specification, as the ability to create multiple-rendition
					containers pre-dates this specification.</p>

				<p>It is strongly <em class="rfc2119">RECOMMENDED</em>, however, that all future needs for multiple renditions in a container
					follow this specification. Existing implementations that utilize other methods for selecting from
					multiple renditions are also encouraged to consider migrating to use this specification to improve
					the overall interoperability of <a data-link-type="dfn" href="#dfn-multiple-rendition-publications" class="internalDFN" id="ref-for-dfn-multiple-rendition-publications-1">multiple-rendition publications</a>.</p>

				<p>Some of the <a href="#rendition-selection-attr">rendition selection attributes</a> defined in this
					specification share common names with package document elements and properties [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] as they
					are designed to reflect that information for selection purposes.</p>

				<p>Despite this commonality, this specification does not enforce equivalence between the rendition
					selection properties expressed on a <code>rootfile</code> element [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] and the metadata
					expressed in the corresponding package document, as direct equivalence is not always possible.</p>

				<p>For example, a multilingual EPUB publication will define more than one <code><a data-type="element" href="https://www.w3.org/TR/epub-33/#dfn-dc-language">dc:language</a></code> element
					[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] — one for each language — but for rendition selection only the primary
					language is defined. Likewise, the language defined in the package document could include a specific
					region code, but for selection purposes the EPUB creator might identify only the language code.</p>

				<p>The reason for common metadata in both locations is to simplify the selection process: including
					attributes avoids the requirement to parse each referenced package document and allows for
					expressions of primacy that are not possible at the package level. It also avoids collisions and
					ambiguities between metadata being used for different purposes (selection versus rendering).</p>

				<p>The selection properties defined in the <a href="https://www.w3.org/TR/epub-33/#sec-container-metainf-container.xml"><code>container.xml</code> file</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] have no rendering behaviors attached to
					them, either. For example, indicating that a rendition is fixed layout in the <a href="#layout-attr"><code>rendition:layout</code> attribute</a> does not trigger fixed layout rendering
					behaviors within the specified rendition.</p>

				<p>A reading system renders a rendition according to the metadata expressed in the package document
					only.</p>
			</section>

			<section id="terminology"><div class="header-wrapper"><h3 id="x1-4-terminology"><bdi class="secno">1.4 </bdi>Terminology</h3><a class="self-link" href="#terminology" aria-label="Permalink for Section 1.4"></a></div>
				

				<p>This specification uses <a href="https://www.w3.org/TR/epub-33/#sec-terminology">terminology defined in EPUB 3</a>
					[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</p>

				<p>It also defines the following terms:</p>

				<dl>
					<dt><dfn id="dfn-container-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">container document</dfn></dt>
					<dd>
						<p>The <a href="https://www.w3.org/TR/epub-33/#sec-container-metainf-container.xml"><code>container.xml</code>
								file</a> located in the child <a href="https://www.w3.org/TR/epub-33/#sec-container-metainf"><code>META-INF</code> directory</a> of the EPUB container root directory
							[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>]. Each <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-4">rendition</a> in the container is identified by a <code>rootfile</code>
							element [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</p>
					</dd>

					<dt><dfn id="dfn-default-rendition" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">default rendition</dfn></dt>
					<dd>
						<p>The <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-5">rendition</a> listed in the first <code>rootfile</code> element in the <a href="https://www.w3.org/TR/epub-33/#sec-container-metainf-container.xml"><code>container.xml</code>
								file</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</p>
					</dd>

					<dt><dfn data-lt="multiple-rendition publications|multiple-rendition publication" id="dfn-multiple-rendition-publications" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">multiple-rendition publication</dfn></dt>
					<dd>
						<p>An EPUB publication that consists of two or more <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-6">renditions</a> of the content.</p>
					</dd>

					<dt><dfn data-plurals="renditions" id="dfn-rendition" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">rendition</dfn></dt>
					<dd>
						<p>One rendering of the content of an EPUB publication, as expressed by a package document.</p>
					</dd>

					<dt><dfn data-lt="rendition mapping documents|rendition mapping document" id="dfn-rendition-mapping-documents" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">rendition mapping document</dfn></dt>
					<dd>
						<p>A specialization of the XHTML content document, containing machine-readable mappings between
							equivalent content in different <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-7">renditions</a>, conforming to the constraints expressed in
								<a href="#rendition-mapping">rendition mapping</a>.</p>
					</dd>
				</dl>

				<div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span></div><div class="">
					<p>Only the first instance of a term in a section links to its definition.</p>
				</div></div>
			</section>

			<section id="conformance"><div class="header-wrapper"><h3 id="x1-5-conformance"><bdi class="secno">1.5 </bdi>Conformance</h3><a class="self-link" href="#conformance" aria-label="Permalink for Section 1.5"></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">OPTIONAL</em>, <em class="rfc2119">RECOMMENDED</em>, and <em class="rfc2119">SHOULD</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p></section>
		</section>
		<section id="container"><div class="header-wrapper"><h2 id="x2-specifying-multiple-renditions"><bdi class="secno">2. </bdi>Specifying multiple renditions</h2><a class="self-link" href="#container" aria-label="Permalink for Section 2."></a></div>
			

			<p>Each rendition of an <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-publication">EPUB publication</a> <em class="rfc2119">MUST</em> meet the <a href="https://www.w3.org/TR/epub-33/#sec-epub-conf">requirements
					for EPUB publications</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</p>

			<p>The <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-package-document">package document</a> for each rendition <em class="rfc2119">MUST</em> be listed in the <code>container.xml</code> file
				[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>], where the first package document listed represents the <a data-link-type="dfn" href="#dfn-default-rendition" class="internalDFN" id="ref-for-dfn-default-rendition-2">default rendition</a>.</p>

			<aside class="example" id="example-1"><div class="marker">
    <a class="self-link" href="#example-1">Example<bdi> 1</bdi></a>
  </div>
				<p>The following example shows SVG and XHTML renditions bundled in the same container:</p>

				<pre id="sep-dir" aria-busy="false"><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"urn:oasis:names:tc:opendocument:xmlns:container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">rootfiles</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"SVG/Sandman.opf"</span>
            <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"XHTML/Sandman.opf"</span>
            <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">rootfiles</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></code></pre>
			</aside>

			<p>Each rendition of the EPUB publication <em class="rfc2119">SHOULD</em> only list the <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-publication-resource">publication resources</a> necessary for its
				rendering in its package document <a data-link-type="dfn" data-lt="EPUB manifest" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-manifest">manifest</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>]. renditions <em class="rfc2119">MAY</em> reference the
				same publication resources.</p>

			<div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="3"><span>Note</span></div><div class="">
				<p>Renditions may not be able to access resources stored in sibling directories on all reading systems
					(i.e., some reading systems do not provide access outside the directory a rendition's package
					document is stored in).</p>

				<p>For example, given the following directory structure (all resources except the package documents
					omitted for clarity):</p>

				<pre aria-busy="false"><code class="hljs">/META-INF
/Rendition1
   - rendition1.opf
/Rendition2
   - rendition2.opf
/Shared</code></pre>

				<p>Resources in the "<code>Rendition1</code>" directory may not be able to access resources in either
						"<code>Rendition2</code>" or "<code>Shared</code>".</p>

				<p>To share resources between renditions, it is recommended that the package documents be located in a
					common directory and the resources for each rendition stored in separate subdirectories.</p>

				<p>Restructuring the previous example as follows would allow shared access to all resources:</p>

				<pre class="prettyprint" aria-busy="false"><code class="hljs">/META-INF
/EPUB
   /Rendition1
   /Rendition2
   /Shared
   - rendition1.opf
   - rendition2.opf</code></pre>
			</div></div>
		</section>
		<section id="sec-metadata"><div class="header-wrapper"><h2 id="x3-expressing-metadata"><bdi class="secno">3. </bdi>Expressing metadata</h2><a class="self-link" href="#sec-metadata" aria-label="Permalink for Section 3."></a></div>
			

			<section id="rendition-metadata"><div class="header-wrapper"><h3 id="x3-1-rendition-metadata"><bdi class="secno">3.1 </bdi>Rendition metadata</h3><a class="self-link" href="#rendition-metadata" aria-label="Permalink for Section 3.1"></a></div>
				

				<p>Metadata expressed at the rendition level <em class="rfc2119">MAY</em> change from instance to instance. For example,
					renditions in different languages will have different primary languages and language-specific
					metadata such as titles will be expressed differently. Similarly, bundled fixed-layout and
					reflowable renditions will express different rendering metadata.</p>
			</section>

			<section id="pub-metadata"><div class="header-wrapper"><h3 id="x3-2-publication-metadata"><bdi class="secno">3.2 </bdi>Publication metadata</h3><a class="self-link" href="#pub-metadata" aria-label="Permalink for Section 3.2"></a></div>
				

				<section id="pub-metadata-file"><div class="header-wrapper"><h4 id="x3-2-1-the-metadata-xml-file"><bdi class="secno">3.2.1 </bdi>The <code>metadata.xml</code> file</h4><a class="self-link" href="#pub-metadata-file" aria-label="Permalink for Section 3.2.1"></a></div>
					

					<p>To ensure consistency of metadata at the Publication and <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-8">rendition</a> levels, this specification
						defines the content model of the root <code>metadata</code> element in the <a href="https://www.w3.org/TR/epub-33/#sec-container-metainf-metadata.xml"><code>metadata.xml</code> file</a>
						[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] to be the same as the package document <a href="https://www.w3.org/TR/epub-33/#elemdef-opf-metadata"><code>metadata</code> element</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>], with the following differences in syntax
						and semantics:</p>

					<ul>
						<li>A <code>dc:identifier</code> element [<cite><a class="bibref" data-link-type="biblio" href="#bib-dcterms" title="DCMI Metadata Terms">dcterms</a></cite>] <em class="rfc2119">MUST</em> contain the <a href="https://www.w3.org/TR/epub-33/#sec-opf-dcidentifier">unique identifier</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] for the EPUB
							publication.</li>
						<li>A <code>meta</code> element [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] <em class="rfc2119">MUST</em> contain the last modified date, expressed using
							the <code>dcterms:modified</code> property [<cite><a class="bibref" data-link-type="biblio" href="#bib-dcterms" title="DCMI Metadata Terms">dcterms</a></cite>]. The value of the property <em class="rfc2119">MUST</em>
							conform to the pattern and rules defined in <a href="https://www.w3.org/TR/epub-33/#sec-metadata-last-modified">Last modified date</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>]. Only
							one <code>dcterms:modified</code> property without a <a href="https://www.w3.org/TR/epub-33/#attrdef-refines"><code>refines</code> attribute</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] is allowed.</li>
						<li>All other metadata is <em class="rfc2119">OPTIONAL</em>.</li>
						<li>The obsolete <a href="https://www.w3.org/TR/epub-33/#sec-opf2-meta">OPF2 <code>meta</code> element</a>
							[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] is not allowed.</li>
						<li>The <code>meta</code> and <code>link</code> elements are defined in the same namespace as
							the <code>metadata</code> root element: <code class="uri"><a href="http://www.idpf.org/2013/metadata">http://www.idpf.org/2013/metadata</a></code></li>
						<li>In order to enable the full expression of metadata in the <code>metadata.xml</code> file,
							all attributes allowed on the <code><a data-type="element" href="https://www.w3.org/TR/epub-33/#dfn-package">package</a></code> element [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] are allowed on the root <code class="markup">metadata</code> element.</li>
					</ul>

					<div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="5"><span>Note</span></div><div class="">
						<p>The content of this file is also defined informally through an XML schema. See <a href="#schema-metadata" class="sec-ref"><bdi class="secno">A.1 </bdi>Metadata.xml Schema</a> for further details.</p>
					</div></div>

					<p>This specification does not define a model for the inheritance of metadata from the Publication
						level to the <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-9">rendition</a> level, as EPUB processing only requires that the <a href="#dfn-default-rendition" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-default-rendition-3">default
							rendition</a> be recognized by reading systems (i.e., reliance on inheritance could result
						in reading systems not locating necessary metadata).</p>

					<div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="5"><span>Note</span></div><div class="">
						<p>EPUB creators are strongly encouraged to include a complete set of Publication metadata in
							the default rendition to ensure cross-compatibility, even when making use of this file.</p>
						<p>Titles, languages and other metadata is often not applicable from one rendition to another,
							further complicating the sharing of metadata. No assumption can be made that metadata in the
								<code>metadata.xml</code> file is applicable to any given rendition, whether the
							metadata is expressed in the rendition or not.</p>
					</div></div>

					<div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-3" aria-level="5"><span>Note</span></div><div class="">
						<p>As [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] does not define a content model for the <code>metadata.xml</code> file, EPUB
							publications that do not conform to this specification can include different metadata. EPUB
							publications that are not valid to the content model restrictions in this section are not
							valid <a data-link-type="dfn" href="#dfn-multiple-rendition-publications" class="internalDFN" id="ref-for-dfn-multiple-rendition-publications-2">multiple-rendition publications</a> as defined by this specification, but might still
							be valid EPUB 3 publications.</p>
						<p>EPUB creators are strongly encouraged to migrate to the content model defined in this
							specification, even if not producing multiple-rendition publications, to ensure consistent
							processing.</p>
					</div></div>

					<section id="pub-metadata-obfuscation"><div class="header-wrapper"><h5 id="x3-2-1-1-resource-obfuscation"><bdi class="secno">3.2.1.1 </bdi>Resource obfuscation</h5><a class="self-link" href="#pub-metadata-obfuscation" aria-label="Permalink for Section 3.2.1.1"></a></div>
						

						<p>The <a href="https://www.w3.org/TR/epub-33/#obfus-algorithm">resource obfuscation algorithm</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>]
							depends on creating an <a href="https://www.w3.org/TR/epub-33/#obfus-keygen">obfuscation key</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>]
							from the <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-unique-identifier">unique identifier</a> for the EPUB publication.</p>

						<p>For compatibility reasons, and due to the complexities of being able to share resources
							across renditions, this specification does not change this requirement but applies it to all
							obfuscated resources in the EPUB container.</p>

						<p>Consequently, EPUB creators <em class="rfc2119">MUST</em> use the unique identifier of the <a data-link-type="dfn" href="#dfn-default-rendition" class="internalDFN" id="ref-for-dfn-default-rendition-4">default rendition</a> as
							the obfuscation key for all resources in a <a data-link-type="dfn" href="#dfn-multiple-rendition-publications" class="internalDFN" id="ref-for-dfn-multiple-rendition-publications-3">multiple-rendition publication</a>.</p>

						<p>Similarly, <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-reading-system">reading systems</a> <em class="rfc2119">MUST</em> use this unique identifier of the default rendition to
							de-obfuscate all resources in a multiple-rendition publication.</p>
					</section>
				</section>

				<section id="vocab-assoc"><div class="header-wrapper"><h4 id="x3-2-2-vocabulary-association-mechanisms"><bdi class="secno">3.2.2 </bdi>Vocabulary association mechanisms</h4><a class="self-link" href="#vocab-assoc" aria-label="Permalink for Section 3.2.2"></a></div>
					

					<p>This specification inherits the mechanisms for associating vocabularies defined in <a href="https://www.w3.org/TR/epub-33/#sec-vocab-assoc">Vocabulary Association Mechanisms</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] as
						they relate to the package document metadata, with only the following modification: the
							<code>prefix</code> attribute <em class="rfc2119">MAY</em> be attached only to the root <code>metadata</code>
						element.</p>

					<p><a href="https://www.w3.org/TR/epub-33/#sec-reserved-prefixes">Reserved prefixes</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] for metadata
						attribute expressions are adopted without change.</p>
				</section>
			</section>
		</section>
		<section id="rendition-selection"><div class="header-wrapper"><h2 id="x4-rendition-selection"><bdi class="secno">4. </bdi>Rendition selection</h2><a class="self-link" href="#rendition-selection" aria-label="Permalink for Section 4."></a></div>
			

			<section id="rendition-selection-intro"><div class="header-wrapper"><h3 class="informative" id="x4-1-introduction"><bdi class="secno">4.1 </bdi>Introduction</h3><a class="self-link" href="#rendition-selection-intro" aria-label="Permalink for Section 4.1"></a></div>
				

				<p>Although each EPUB publication represents a single work, it is possible to optimize the rendering of
					that work in any number of different ways. An issue of a magazine, for example, could include a
					fixed layout version (print replica) for rendering on tablet-sized screens with a reflowable version
					for smaller cellphone screens where the fixed layout would be scaled to illegibility (or
					automatically reflowed in unwanted ways if fixed layouts are not supported).</p>

				<p>The EPUB container allows multiple <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-10">renditions</a> of the content to be included in an EPUB
					publication, but does not specify how reading systems are to determine the unique properties of the
					renditions listed in the container document, or select between them.</p>

				<p>This section redresses this problem by defining both a set of rendition selection attributes that can
					be attached to <a href="https://www.w3.org/TR/epub-33/#sec-container-metainf-container.xml"><code>rootfile</code>
						elements</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] in the container document and a processing model that allows EPUB
					creators to specify which rendition is the best representation depending on various conditions.
					Reading systems can then select the appropriate representation from the list of renditions to match
					the current configuration and user preferences.</p>
			</section>

			<section id="rendition-selection-pub-confomance"><div class="header-wrapper"><h3 id="x4-2-content-conformance"><bdi class="secno">4.2 </bdi>Content conformance</h3><a class="self-link" href="#rendition-selection-pub-confomance" aria-label="Permalink for Section 4.2"></a></div>
				

				<p>A container document:</p>

				<ul class="conformancelist">
					<li id="confreq-container"><em class="rfc2119">MUST</em> be valid to the definition and requirements for the
							<code>container.xml</code> file specified in <a href="https://www.w3.org/TR/epub-33/#sec-container-metainf-container.xml">container –
							META-INF/container.xml</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</li>
					<li id="confreq-selection-attr"><em class="rfc2119">MAY</em> include any of the selection attributes defined in <a href="#rendition-selection-attr">Rendition selection attributes</a>.</li>
					<li id="confreq-selection-default"><em class="rfc2119">MAY</em> Include selection attributes on the <a href="https://www.w3.org/TR/epub-33/#sec-container.xml-rootfiles-elem"><code>rootfile</code> element</a>
						[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] for the <a data-link-type="dfn" href="#dfn-default-rendition" class="internalDFN" id="ref-for-dfn-default-rendition-5">default rendition</a></li>
					<li id="confreq-selection-min"><em class="rfc2119">SHOULD</em> include at least one selection attribute ‒ in addition to the
						<em class="rfc2119">OPTIONAL</em> label ‒ on each subsequent <code>rootfile</code> element.</li>
				</ul>
			</section>

			<section id="rendition-selection-rs-conformance"><div class="header-wrapper"><h3 id="x4-3-reading-system-conformance"><bdi class="secno">4.3 </bdi>reading system conformance</h3><a class="self-link" href="#rendition-selection-rs-conformance" aria-label="Permalink for Section 4.3"></a></div>
				

				<p>An EPUB reading system <em class="rfc2119">SHOULD</em> determine the rendition to present to a user as defined in <a href="#rendition-selection-proc-model" class="sec-ref"><bdi class="secno">4.5 </bdi>Processing model</a>.</p>
			</section>

			<section id="rendition-selection-attr"><div class="header-wrapper"><h3 id="x4-4-rendition-selection-attributes"><bdi class="secno">4.4 </bdi>Rendition selection attributes</h3><a class="self-link" href="#rendition-selection-attr" aria-label="Permalink for Section 4.4"></a></div>
				

				<div class="note" role="note" id="issue-container-generatedID-4"><div role="heading" class="note-title marker" id="h-note-4" aria-level="4"><span>Note</span></div><div class="">
					<p>The use of the rendition selection attributes in the <a href="https://www.w3.org/TR/epub-33/#sec-container-metainf-container.xml"><code>container.xml</code> file</a>
						[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] is also defined informally through an XML schema. See <a href="#schema-container" class="sec-ref"><bdi class="secno">A.2 </bdi>Container.xml schema</a> for further details.</p>
				</div></div>

				<section id="media-attr"><div class="header-wrapper"><h4 id="x4-4-1-the-rendition-media-attribute"><bdi class="secno">4.4.1 </bdi>The <code>rendition:media</code> attribute</h4><a class="self-link" href="#media-attr" aria-label="Permalink for Section 4.4.1"></a></div>
					

					<p>The <code>rendition:media</code> attribute identifies the media features of a reading system the
						given <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-11">rendition</a> is best suitable for rendering on.</p>

					<div class="elem-synopsis" id="attrdef-media">
						<dl>
							<dt class="varlistentry">
								<span class="term">Attribute Name</span>
							</dt>
							<dd>
								<p>
									<code>media</code>
								</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Namespace</span>
							</dt>
							<dd>
								<p>
									<code class="uri">http://www.idpf.org/2013/rendition</code>
								</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Usage</span>
							</dt>
							<dd>
								<p><em class="rfc2119">MAY</em> be specified on container document <code>rootfile</code> elements
									[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Value</span>
							</dt>
							<dd>
								<p>A CSS 3 media query [<cite><a class="bibref" data-link-type="biblio" href="#bib-mediaqueries" title="Media Queries Level 4">mediaqueries</a></cite>], where the media type, if specified, <em class="rfc2119">MUST</em> only
									be the value "<code>all</code>".</p>
							</dd>
						</dl>
					</div>

					<p>As per [<cite><a class="bibref" data-link-type="biblio" href="#bib-mediaqueries" title="Media Queries Level 4">mediaqueries</a></cite>], the media query in this attribute <em class="rfc2119">MUST</em> evaluate to true in order for the
						given rendition to be selected for rendering. Media queries that evaluate to "not all” per <a href="https://www.w3.org/TR/mediaqueries-4/#error-handling">3.1 Error Handling</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-mediaqueries" title="Media Queries Level 4">mediaqueries</a></cite>] <em class="rfc2119">SHOULD</em> be
						treated as false for the purposes of rendition selection (i.e., the given rendition is not a
						valid match).</p>

					<aside class="example" id="example-2"><div class="marker">
    <a class="self-link" href="#example-2">Example<bdi> 2</bdi></a>
  </div>
						<p>The following example shows two renditions of The Sandman bundled in the same container, one
							optimized for screens 1920 pixels or wider. The default rendition will be used for screen
							sizes smaller than 1920 pixels by default.</p>

						<pre aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"urn:oasis:names:tc:opendocument:xmlns:container"</span>
           <span class="hljs-attr">xmlns:rendition</span>=<span class="hljs-string">"http://www.idpf.org/2013/rendition"</span>
           <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">rootfiles</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"Sandman.opf"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span>/&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"Sandman-large.opf"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span>
            <span class="hljs-attr">rendition:media</span>=<span class="hljs-string">"(min-width: 1920px)"</span>/&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-name">rootfiles</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></code></pre>
					</aside>
				</section>

				<section id="layout-attr"><div class="header-wrapper"><h4 id="x4-4-2-the-rendition-layout-attribute"><bdi class="secno">4.4.2 </bdi>The <code>rendition:layout</code> attribute</h4><a class="self-link" href="#layout-attr" aria-label="Permalink for Section 4.4.2"></a></div>
					

					<p>The <code>rendition:layout</code> attribute indicates whether the given <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-12">rendition</a> is
						reflowable or pre-paginated.</p>

					<div class="elem-synopsis" id="attrdef-layout">
						<dl>
							<dt class="varlistentry">
								<span class="term">Attribute Name</span>
							</dt>
							<dd>
								<p>
									<code>layout</code>
								</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Namespace</span>
							</dt>
							<dd>
								<p>
									<code class="uri">http://www.idpf.org/2013/rendition</code>
								</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Usage</span>
							</dt>
							<dd>
								<p><em class="rfc2119">MAY</em> be specified on container document <code>rootfile</code> elements
									[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Value</span>
							</dt>
							<dd>
								<p>The value of the attribute <em class="rfc2119">MUST</em> be <code class="markup">reflowable</code> or
										<code>pre-paginated</code>.</p>
							</dd>
						</dl>
					</div>

					<p>When specified, the value of this attribute <em class="rfc2119">MUST</em> match the <a href="https://www.w3.org/TR/epub-33/#property-layout-global">global rendition:layout setting</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>]
						for the referenced rendition.</p>

					<p>If a user layout preference is defined in the reading system, the attribute evaluates to true if
						the preference matches the specified value, otherwise it evaluates to false. If no user
						preference is defined, the reading system <em class="rfc2119">SHOULD</em> ignore the attribute when selecting from the
						available renditions.</p>

					<aside class="example" id="example-3"><div class="marker">
    <a class="self-link" href="#example-3">Example<bdi> 3</bdi></a>
  </div>
						<p>The following example shows two renditions of a magazine bundled in the same container. Note
							that it is not necessary to state that the default rendition is reflowable, since renditions
							are reflowable by default.</p>
						<pre aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"urn:oasis:names:tc:opendocument:xmlns:container"</span>
           <span class="hljs-attr">xmlns:rendition</span>=<span class="hljs-string">"http://www.idpf.org/2013/rendition"</span>
           <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">rootfiles</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"EPUB/reflow/magazine.opf"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span>/&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"EPUB/fxl/magazine.opf"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span>
           <span class="hljs-attr">rendition:layout</span>=<span class="hljs-string">"pre-paginated"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">rootfiles</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></code></pre>
					</aside>
				</section>

				<section id="language-attr"><div class="header-wrapper"><h4 id="x4-4-3-the-rendition-language-attribute"><bdi class="secno">4.4.3 </bdi>The <code>rendition:language</code> attribute</h4><a class="self-link" href="#language-attr" aria-label="Permalink for Section 4.4.3"></a></div>
					

					<p>The <code>rendition:language</code> attribute indicates that the given <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-13">rendition</a> is optimized
						for the specified language. </p>

					<div class="elem-synopsis" id="attrdef-language">
						<dl>
							<dt class="varlistentry">
								<span class="term">Attribute Name</span>
							</dt>
							<dd>
								<p>
									<code>language</code>
								</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Namespace</span>
							</dt>
							<dd>
								<p>
									<code class="uri">http://www.idpf.org/2013/rendition</code>
								</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Usage</span>
							</dt>
							<dd>
								<p><em class="rfc2119">MAY</em> be specified on container document <code>rootfile</code> elements
									[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Value</span>
							</dt>
							<dd>
								<p><em class="rfc2119">MUST</em> contain a valid language code conforming to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5646" title="Tags for Identifying Languages">rfc5646</a></cite>].</p>
							</dd>
						</dl>
					</div>

					<p>The <code>rendition:language</code> attribute more precisely identifies the primary language of a
						rendition than does the inclusion of <code>dc:language</code> elements in the rendition's
						package document, as the presence of <code>dc:language</code> elements only indicates that the
						specified languages are prominently used in the prose.</p>

					<p>If a user language preference is defined in the reading system, the attribute evaluates to true
						if the preference matches the specified value, otherwise it evaluates to false. Several matching
						schemes are defined in Section 3 of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4647" title="Matching of Language Tags">rfc4647</a></cite>]. Reading systems can use the most appropriate
						matching scheme. If no user preference is defined, the reading system <em class="rfc2119">SHOULD</em> ignore the
						attribute when selecting from the available renditions.</p>

					<aside class="example" id="example-4"><div class="marker">
    <a class="self-link" href="#example-4">Example<bdi> 4</bdi></a>
  </div>
						<p>The following example shows a multilingual EPUB publication, with English, French and Spanish
							renditions of the content.</p>

						<pre aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"urn:oasis:names:tc:opendocument:xmlns:container"</span>
           <span class="hljs-attr">xmlns:rendition</span>=<span class="hljs-string">"http://www.idpf.org/2013/rendition"</span>
           <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">rootfiles</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"EPUB/en/package.opf"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span>
           <span class="hljs-attr">rendition:language</span>=<span class="hljs-string">"en"</span>/&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"EPUB/fr/package.opf"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span>
           <span class="hljs-attr">rendition:language</span>=<span class="hljs-string">"fr"</span>/&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"EPUB/es/package.opf"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span>
           <span class="hljs-attr">rendition:language</span>=<span class="hljs-string">"es"</span>/&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-name">rootfiles</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></code></pre>
					</aside>
				</section>

				<section id="accessMode-attr"><div class="header-wrapper"><h4 id="x4-4-4-the-rendition-accessmode-attribute"><bdi class="secno">4.4.4 </bdi>The <code>rendition:accessMode</code> attribute</h4><a class="self-link" href="#accessMode-attr" aria-label="Permalink for Section 4.4.4"></a></div>
					

					<p>The <code>rendition:accessMode</code> attribute identifies the way in which intellectual content
						is communicated in a <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-14">rendition</a>, and is based on the [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso24751-3" title=" ISO/IEC 24751-3:2008 Information technology -- Individualized adaptability and accessibility in e-learning, education and training -- Part 3: &amp;quot;Access for all&amp;quot; digital resource description">iso24751-3</a></cite>] "Access Mode"
						property.</p>

					<div class="elem-synopsis" id="attrdef-accessMode">
						<dl>
							<dt class="varlistentry">
								<span class="term">Attribute Name</span>
							</dt>
							<dd>
								<p>
									<code>accessMode</code>
								</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Namespace</span>
							</dt>
							<dd>
								<p>
									<code class="uri">http://www.idpf.org/2013/rendition</code>
								</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Usage</span>
							</dt>
							<dd>
								<p><em class="rfc2119">MAY</em> be specified on container document <code>rootfile</code> elements
									[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Value</span>
							</dt>
							<dd>
								<p><em class="rfc2119">MUST</em> be one or more of the values: <code class="markup">auditory</code>,
										<code>tactile</code>, <code>textual</code> or <code>visual</code></p>
							</dd>
						</dl>
					</div>

					<p>The <code>rendition:accessMode</code> attribute defines the primary access mode(s) for a given
						rendition. For example, although a textual work may include images, audio and video, its primary
						means of conveying information is the text. Likewise, a visual work might include alternative
						text and/or descriptions, but these adaptations are not listed as a textual mode for the
						rendition for the purpose of selection.</p>

					<p>The way in which information is encoded also needs to be considered when designating an access
						mode. If a work has text components, or is completely textual in nature, but that content is
						burned into an image format, the access mode is visual (e.g., character dialogue in a JPEG page
						of a comic or a scan of a document).</p>

					<p>A rendition <em class="rfc2119">MAY</em> include more than one primary access mode. For example, the textual version might
						also embed the auditory version using media overlays. In such cases, the attribute should list
						each primary access mode that is available.</p>

					<p>If a user access mode preference is defined in the reading system, the attribute evaluates to
						true if that preference matches any of the access modes defined in it, otherwise it evaluates to
						false. If no user preference is defined, the reading system <em class="rfc2119">SHOULD</em> ignore the attribute when
						selecting from the available renditions.</p>

					<p>The <a href="#label-attr"><code>rendition:label</code> attribute</a> can be use to inform users
						about the nature of the content, particularly where such information is not available, or not
						yet standardized, for selection. For example, a tactile rendition could indicate the braille
						code and grade in its label, or a textual rendition could be marked as optimized for
						text-to-speech rendering, not general use.</p>

					<aside class="example" id="example-5"><div class="marker">
    <a class="self-link" href="#example-5">Example<bdi> 5</bdi></a>
  </div>
						<p>The following example shows an EPUB publication with an image-based rendition and a
							text-based serialization available.</p>

						<pre aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"urn:oasis:names:tc:opendocument:xmlns:container"</span>
           <span class="hljs-attr">xmlns:rendition</span>=<span class="hljs-string">"http://www.idpf.org/2013/rendition"</span>
           <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">rootfiles</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"EPUB/comic/package.opf"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span>
           <span class="hljs-attr">rendition:accessMode</span>=<span class="hljs-string">"visual"</span>/&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"EPUB/novel/package.opf"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span>
           <span class="hljs-attr">rendition:accessMode</span>=<span class="hljs-string">"textual"</span>/&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-name">rootfiles</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></code></pre>
					</aside>
				</section>

				<section id="label-attr"><div class="header-wrapper"><h4 id="x4-4-5-the-rendition-label-attribute"><bdi class="secno">4.4.5 </bdi>The <code>rendition:label</code> attribute</h4><a class="self-link" href="#label-attr" aria-label="Permalink for Section 4.4.5"></a></div>
					

					<p>The <code>rendition:label</code> attribute allows each <code>rootfile</code> element [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>]
						to be annotated with a human-readable name.</p>

					<div class="elem-synopsis" id="attrdef-label">
						<dl>
							<dt class="varlistentry">
								<span class="term">Attribute Name</span>
							</dt>
							<dd>
								<p>
									<code>label</code>
								</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Namespace</span>
							</dt>
							<dd>
								<p>
									<code class="uri">http://www.idpf.org/2013/rendition</code>
								</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Usage</span>
							</dt>
							<dd>
								<p><em class="rfc2119">MAY</em> be specified on container document <code>rootfile</code> elements
									[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</p>
							</dd>
							<dt class="varlistentry">
								<span class="term">Value</span>
							</dt>
							<dd>
								<p>Text.</p>
							</dd>
						</dl>
					</div>

					<p>The <code>rendition:label</code> attribute provides a name for the given <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-15">rendition</a> (e.g., for
						manual rendition selection).</p>

					<p>The language of the <code>rendition:label</code> attribute <em class="rfc2119">MAY</em> be expressed in an
							<code>xml:lang</code> attribute.</p>

					<aside class="example" id="example-6"><div class="marker">
    <a class="self-link" href="#example-6">Example<bdi> 6</bdi></a>
  </div>
						<p>The following example shows the <code>rendition:label</code> attribute being used to provide
							a human-readable name for a rendition.</p>

						<pre aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"urn:oasis:names:tc:opendocument:xmlns:container"</span>
           <span class="hljs-attr">xmlns:rendition</span>=<span class="hljs-string">"http://www.idpf.org/2013/rendition"</span>
           <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span>
           <span class="hljs-attr">xml:lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">rootfiles</span>&gt;</span>
        …
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"EPUB/package.opf"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span>
           <span class="hljs-attr">rendition:media</span>=<span class="hljs-string">"color, min-width: 1024"</span>
           <span class="hljs-attr">rendition:layout</span>=<span class="hljs-string">"pre-paginated"</span>
           <span class="hljs-attr">rendition:label</span>=<span class="hljs-string">"Color-optimized print replica"</span>/&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-name">rootfiles</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></code></pre>
					</aside>

					<p>The <code>rendition:label</code> attribute is not a selection attribute for the purposes of
						evaluating which rendition to render.</p>
				</section>
			</section>

			<section id="rendition-selection-proc-model"><div class="header-wrapper"><h3 id="x4-5-processing-model"><bdi class="secno">4.5 </bdi>Processing model</h3><a class="self-link" href="#rendition-selection-proc-model" aria-label="Permalink for Section 4.5"></a></div>
				

				<p>This section describes the method by which reading systems locate the optimal <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-16">rendition</a> to
					present to a user.</p>

				<p>rendition selection <em class="rfc2119">SHOULD</em> occur on initial rendering, and reading systems <em class="rfc2119">SHOULD</em> re-evaluate the
					selection in response to changes in the user environment (e.g., change in device orientation or
					viewport size).</p>

				<p>When a change condition is triggered, the reading system <em class="rfc2119">SHOULD</em> evaluate the <code>rootfile</code>
					elements [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] in the container document as follows, starting with the last
						<code>rootfile</code> entry:</p>

				<ul>
					<li>If rendition namespaced attributes are set, check each attribute per its definition in <a href="#rendition-selection-attr" class="sec-ref"><bdi class="secno">4.4 </bdi>Rendition selection attributes</a> to determine if the specified conditions are
						true:</li>
				</ul>
				<ul>
					<li>If all conditions evaluate to true, select the given rendition and exit the selection
						process.</li>
					<li>If any condition is false, move to the preceding <code>rootfile</code> element and continue the
						evaluation process.</li>
					<li>If any unrecognized rendition-namespaced attributes are found, they are ignored for the purposes
						of evaluating a match.</li>
					<li>If no rendition namespaced attributes are found, move to the preceding <code class="markup">rootfile</code> element and continue the evaluation process.</li>
				</ul>

				<p>If the default rendition is reached, select that rendition and exit the process.</p>

				<div class="note" role="note" id="issue-container-generatedID-5"><div role="heading" class="note-title marker" id="h-note-5" aria-level="4"><span>Note</span></div><div class="">
					<p>This processing model does not require that the selection process occur on a user's device, or
						that all renditions be provided in the container. rendition selection could occur on the server
						side of a cloud-based delivery system, for example, and only a single best-match rendition sent
						to the device.</p>
				</div></div>

				<div class="note" role="note" id="issue-container-generatedID-6"><div role="heading" class="note-title marker" id="h-note-6" aria-level="4"><span>Note</span></div><div class="">
					<p>Since EPUB 2 reading systems, and EPUB 3 reading systems that do not support multiple-rendition
						selection, will render the default rendition, EPUB creators need to consider which rendition
						will have the greatest compatibility across reading systems and ensure it is listed first.</p>
				</div></div>

				<p>A reading system <em class="rfc2119">MAY</em> provide the user the option to manually select any of the renditions in the
					container. It <em class="rfc2119">SHOULD</em> use the <a href="#label-attr"><code>rendition:label</code> attribute</a>
					attribute value to present the option, when available.</p>

				<p>As EPUB did not previously define a rendition selection model, custom selection models might be
					encountered in some EPUB publications. When recognized, these selection models <em class="rfc2119">SHOULD</em> be utilized.
					If both rendition selection attributes conformant to this specification and custom attributes are
					defined, the latter <em class="rfc2119">SHOULD</em> be ignored.</p>
			</section>
		</section>
		<section id="rendition-mapping"><div class="header-wrapper"><h2 id="x5-rendition-mapping"><bdi class="secno">5. </bdi>Rendition mapping</h2><a class="self-link" href="#rendition-mapping" aria-label="Permalink for Section 5."></a></div>
			

			<section id="rendition-mapping-intro" class="informative"><div class="header-wrapper"><h3 id="x5-1-introduction"><bdi class="secno">5.1 </bdi>Introduction</h3><a class="self-link" href="#rendition-mapping-intro" aria-label="Permalink for Section 5.1"></a></div><p><em>This section is non-normative.</em></p>
				

				<p>The <a data-link-type="dfn" href="#dfn-rendition-mapping-documents" class="internalDFN" id="ref-for-dfn-rendition-mapping-documents-1">rendition mapping document</a> identifies related content locations across the <a data-link-type="dfn" href="#dfn-rendition" class="internalDFN" id="ref-for-dfn-rendition-17">renditions</a> in
					a <a data-link-type="dfn" href="#dfn-multiple-rendition-publications" class="internalDFN" id="ref-for-dfn-multiple-rendition-publications-4">multiple-rendition publication</a>, allowing reading systems to switch between renditions while
					keeping the user's place.</p>

				<p data-cite="html">The rendition mapping document is represented as XHTML, and uses <code><a data-type="element" href="https://html.spec.whatwg.org/multipage/sections.html#the-nav-element">nav</a></code> elements
					with unordered lists to group the mappings. There is no display component to the rendition mapping
					document; it is designed to enable automated switching. The lack of a rendering context means that
					the XHTML content model for this document is very restrictive, allowing only a single <code><a data-type="element" href="https://html.spec.whatwg.org/multipage/sections.html#the-nav-element">nav</a></code>
					element in the <code><a data-type="element" href="https://html.spec.whatwg.org/multipage/sections.html#the-body-element">body</a></code>, to ease both authoring and processing.</p>

				<p>To enable the mapping of content locations between renditions, the rendition mapping document's
						<code>nav</code> element consists of a series of one or more unordered lists, each of which
					represents a common point across all the renditions (e.g., a chapter, a page or a component within a
					page). The list items in each unordered list represent the set of equivalent link destinations
					across the available renditions for that content (e.g., one link might point to a document
					representing one page of a fixed layout rendition, while the equivalent link to a reflowable
					rendition might point to the corresponding page break indicator within the XHTML content document
					containing the page).</p>

				<p>Knowing the position of the user in the current rendition, when a change in context occurs, or is
					triggered by the user, the reading system can inspect the sibling list items to determine the EPUB
					content document to load that best meets the new conditions.</p>
			</section>

			<section id="rendition-mapping-pub-conformance"><div class="header-wrapper"><h3 id="x5-2-content-conformance"><bdi class="secno">5.2 </bdi>Content conformance</h3><a class="self-link" href="#rendition-mapping-pub-conformance" aria-label="Permalink for Section 5.2"></a></div>
				

				<p>An EPUB publication <em class="rfc2119">MAY</em> include a <a data-link-type="dfn" href="#dfn-rendition-mapping-documents" class="internalDFN" id="ref-for-dfn-rendition-mapping-documents-2">rendition mapping document</a>.</p>

				<p>A conformant rendition mapping document:</p>

				<ul class="conformancelist">
					<li id="confreq-map-xhtml"><em class="rfc2119">MUST</em> conform to all content conformance constraints for XHTML content
						documents as defined in <a href="https://www.w3.org/TR/epub-33/#sec-xhtml-req">XHTML Requirements</a>
						[<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</li>
					<li id="confreq-map-content-model"><em class="rfc2119">MUST</em> conform to all content conformance constraints specific for
						rendition mapping documents expressed in <a href="#rendition-mapping-doc-def">EPUB rendition
							mapping document definition</a>.</li>
					<li id="confreq-map-unlisted"><em class="rfc2119">MUST NOT</em> be listed in the package document manifest of any of the EPUB
						publication's renditions.</li>
				</ul>
			</section>

			<section id="rendition-mapping-rs-conformance"><div class="header-wrapper"><h3 id="x5-3-reading-system-conformance"><bdi class="secno">5.3 </bdi>reading system conformance</h3><a class="self-link" href="#rendition-mapping-rs-conformance" aria-label="Permalink for Section 5.3"></a></div>
				

				<p>Reading systems <em class="rfc2119">SHOULD</em> support the use of <a data-link-type="dfn" href="#dfn-rendition-mapping-documents" class="internalDFN" id="ref-for-dfn-rendition-mapping-documents-3">rendition mapping documents</a> to switch between content. </p>

				<p>A reading system that supports mapping:</p>

				<ul class="conformancelist">
					<li id="confreq-rs-remap"><em class="rfc2119">MUST</em>, when a change in renditions occurs, locate the current position in
						the rendition mapping document and load the matching position in the new rendition.</li>
				</ul>
			</section>

			<section id="rendition-mapping-doc-def"><div class="header-wrapper"><h3 id="x5-4-epub-rendition-mapping-document-definition"><bdi class="secno">5.4 </bdi>EPUB rendition mapping document definition</h3><a class="self-link" href="#rendition-mapping-doc-def" aria-label="Permalink for Section 5.4"></a></div>
				

				<div class="note" role="note" id="issue-container-generatedID-7"><div role="heading" class="note-title marker" id="h-note-7" aria-level="4"><span>Note</span></div><div class="">
					<p>The content of this file is also defined informally through an XML schema. See <a href="#schema-mapping-doc" class="sec-ref"><bdi class="secno">A.3 </bdi>Mapping document schema</a> for further details.</p>
				</div></div>

				<section id="rendition-mapping-doc-xhtml"><div class="header-wrapper"><h4 id="x5-4-1-xhtml-content-document-restrictions"><bdi class="secno">5.4.1 </bdi>XHTML content document: restrictions</h4><a class="self-link" href="#rendition-mapping-doc-xhtml" aria-label="Permalink for Section 5.4.1"></a></div>
					

					<p>The <a data-link-type="dfn" href="#dfn-rendition-mapping-documents" class="internalDFN" id="ref-for-dfn-rendition-mapping-documents-4">rendition mapping document</a> is a compliant XHTML content document, but with the following
						restrictions on the [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">html</a></cite>] content model:</p>

					<ul>
						<li>No attributes are allowed on the <code>html</code>, <code>head</code>, <code>body</code>,
								<code>ul</code> and <code>li</code> elements. (The <code>xmlns</code> pseudo-attribute
							for namespace declarations is allowed.) The <code>nav</code> element only accepts an
								<code>epub:type</code> attribute.</li>
						<li>The <code>head</code> <em class="rfc2119">MAY</em> contain only <code>meta</code> elements. Only the
								<code>charset</code> attribute or <code>name</code> and <code class="markup">content</code> attributes <em class="rfc2119">MAY</em> be attached to the <code>meta</code> elements.</li>
						<li>The <code>head</code> <em class="rfc2119">MUST</em> include a <code>meta</code> element whose <code>name</code>
							attribute has the value "<code>epub.multiple.renditions.version</code>" and whose
								<code>content</code> attribute has the value "<code>1.0</code>". Reading systems <em class="rfc2119">MAY</em>
							ignore all other <code>meta</code> elements.</li>
						<li>The <code>body</code> element <em class="rfc2119">MUST</em> include exactly one <code>nav</code> element child whose
								<code>epub:type</code> attribute specifies the value "<code>resource-map</code>", and
							<em class="rfc2119">MAY</em> include one or more optional <code>nav</code> elements. No other [<cite><a class="bibref" data-link-type="biblio" href="#bib-html" title="HTML Standard">html</a></cite>] content is
							allowed as a child of the <code>body</code>.</li>
					</ul>
				</section>

				<section id="rendition-mapping-doc-nav"><div class="header-wrapper"><h4 id="x5-4-2-the-nav-element-modifications-and-restrictions"><bdi class="secno">5.4.2 </bdi>The nav element: modifications and restrictions</h4><a class="self-link" href="#rendition-mapping-doc-nav" aria-label="Permalink for Section 5.4.2"></a></div>
					

					<p>This specification restricts the content model of <code>nav</code> elements and their descendants
						in the <a data-link-type="dfn" href="#dfn-rendition-mapping-documents" class="internalDFN" id="ref-for-dfn-rendition-mapping-documents-5">rendition mapping document</a> as follows:</p>

					<ul>
						<li>Each <code>nav</code> element <em class="rfc2119">MUST</em> identify its nature in an <code>epub:type</code>
							attribute.</li>
						<li>The rendition mapping documents uses unordered lists (<code>ul</code>) in place of ordered
							lists (<code>ol</code>).</li>
						<li>The <code>nav</code> element <em class="rfc2119">MAY</em> contain one or more <code>ul</code> element.</li>
						<li>Each list item (<code>li</code>) <em class="rfc2119">MUST</em> contain exactly one <code>a</code> element (i.e.,
								<code>span</code> headings and nested lists are forbidden).</li>
						<li><code>a</code> elements <em class="rfc2119">MUST</em> be empty.</li>
						<li>
							<p>The <code>a</code> element <em class="rfc2119">MUST</em> specify the rendition it is referring to either:</p>
							<ul>
								<li>by using an <a href="http://idpf.org/epub/linking/cfi/#sec-intra-cfis">Intra-Publication CFI</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epubcfi-11" title="EPUB Canonical Fragment Identifiers 1.1">epubcfi-11</a></cite>] as the value of the <code>href</code>
									attribute or,</li>
								<li>by having an <code>epub:rendition</code> attribute whose value is the relative path
									to the Publication Document for the rendition.</li>
							</ul>
						</li>
					</ul>
				</section>

				<section id="rendition-mappings"><div class="header-wrapper"><h4 id="x5-4-3-rendition-mappings"><bdi class="secno">5.4.3 </bdi>Rendition mappings</h4><a class="self-link" href="#rendition-mappings" aria-label="Permalink for Section 5.4.3"></a></div>
					

					<p>Each <code>ul</code> element in the <a data-link-type="dfn" href="#dfn-rendition-mapping-documents" class="internalDFN" id="ref-for-dfn-rendition-mapping-documents-6">rendition mapping document</a> <code class="markup">resource-map</code>
						<code>nav</code> element identifies a content location, listing in its child <code>li</code>
						elements where that location is found in each of the available renditions. Consequently, each
							<code>ul</code> element <em class="rfc2119">MUST</em> contain an <code>li</code> for each rendition.</p>

					<div class="note" role="note" id="issue-container-generatedID-8"><div role="heading" class="note-title marker" id="h-note-8" aria-level="5"><span>Note</span></div><div class="">
						<p>In order to allow a broad variety of use cases, this specification does not impose any
							particular level of mapping granularity. For example, some publications aimed at language
							learners may define sentence-level synchronisation points, whereas other types of
							publications may only map major sections across renditions.</p>
					</div></div>

					<p>Each list item in the unordered list <em class="rfc2119">MUST</em> identify an EPUB content document, or a fragment
						therein, for one of the renditions ‒ defined in a child <code>a</code> element. Each of these
						links <em class="rfc2119">MUST</em> reference a <a href="https://www.w3.org/TR/epub-33/#sec-itemref-elem">linear Top-level content
							document</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>].</p>

					<p>Each <code>a</code> element <em class="rfc2119">MUST</em> specify which rendition it refers to either 1) by including an
							<a href="http://idpf.org/epub/linking/cfi/#sec-intra-cfis">Intra-Publication CFI</a>
						[<cite><a class="bibref" data-link-type="biblio" href="#bib-epubcfi-11" title="EPUB Canonical Fragment Identifiers 1.1">epubcfi-11</a></cite>] in its <code>href</code> attribute, or 2) by providing the relative path to the
						package document for the rendition as the value of an <code>epub:rendition</code> attribute.</p>

					<p>If the <code>epub:rendition</code> attribute is used to specify the target rendition, any
						fragment identifier scheme <em class="rfc2119">MAY</em> be used within the URL value of the <code>href</code> attribute
						of <code>a</code> elements (e.g., unique identifier, or <abbr title="World Wide Web Consortium">W3C</abbr> Media Fragment).</p>

					<div class="note" role="note" id="issue-container-generatedID-9"><div role="heading" class="note-title marker" id="h-note-9" aria-level="5"><span>Note</span></div><div class="">
						<p>The use of [<cite><a class="bibref" data-link-type="biblio" href="#bib-epubcfi-11" title="EPUB Canonical Fragment Identifiers 1.1">epubcfi-11</a></cite>] expressions is strongly encouraged over other fragment identifier
							schemes (particularly in the context of reflowable XHTML content documents), as they allow
							reading systems to ingest rendition mappings without any prior pre-processing. Conversely,
							the use of unique identifiers forces reading systems to load the targeted EPUB content
							documents and process their DOM in order to sort/compare the link destinations (in relation
							to document order). This additional processing has performance implications, and
							implementation costs in terms of caching, incremental updating, etc.</p>
					</div></div>

					<aside class="example" id="example-7"><div class="marker">
    <a class="self-link" href="#example-7">Example<bdi> 7</bdi></a>
  </div>
						<p>The following example shows a rendition mapping document for a magazine with 3 renditions:
							text, portrait and landscape. ‘article 1' is on pages 5 and 6 of the fixed layout renditions
							and the landscape rendition uses spreads (non-synthetic).</p>

						<pre aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/1999/xhtml"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">epub:type</span>=<span class="hljs-string">"resource-map"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
             <span class="hljs-comment">&lt;!-- First Page of the Article 1 --&gt;</span>
                 <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
                     <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>= <span class="hljs-string">"../../text/default.opf#epubcfi(/6/8[article1]!/4/2:20)"</span> /&gt;</span>
                 <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                 <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
                     <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"../../images/page5.png"</span>
                        <span class="hljs-attr">epub:rendition</span>=<span class="hljs-string">"../../portrait/portrait.opf"</span> /&gt;</span>
                 <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
             <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
             <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                 <span class="hljs-comment">&lt;!-- Second Page of the Article 1 --&gt;</span>
                 <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
                     <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>= <span class="hljs-string">"../../text/default.opf#epubcfi(/6/8[article1]!/4/22:40)"</span> /&gt;</span>
                 <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                 <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
                     <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"../../images/page6.png"</span>
                        <span class="hljs-attr">epub:rendition</span>=<span class="hljs-string">"../../portrait/portrait.opf"</span> /&gt;</span>
                 <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
             <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
             <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                 <span class="hljs-comment">&lt;!-- Article 1 --&gt;</span>
                 <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
                     <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>= <span class="hljs-string">"../../text/default.opf#epubcfi(/6/8[article1])"</span> /&gt;</span>
                 <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                 <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
                     <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"../../images/page5-6.png"</span>
                        <span class="hljs-attr">epub:rendition</span>=<span class="hljs-string">"../../landscape/landscape.opf"</span> /&gt;</span>
                 <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
             <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre>
					</aside>

					<aside class="example" id="example-8"><div class="marker">
    <a class="self-link" href="#example-8">Example<bdi> 8</bdi></a>
  </div>
						<p>The following example shows a multilingual EPUB publication with each language in a separate
							rendition.</p>

						<pre aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.w3.org/1999/xhtml"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">epub:type</span>=<span class="hljs-string">"resource-map"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                <span class="hljs-comment">&lt;!-- Chapter 1 --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../en/en.opf#epubcfi(/6/2)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../fr/fr.opf#epubcfi(/6/4)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../de/de.opf#epubcfi(/6/2)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../es/es.opf#epubcfi(/6/6)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../it/it.opf#epubcfi(/6/2)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                 <span class="hljs-comment">&lt;!-- Chapter 2 --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../en/en.opf#epubcfi(/6/4)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../fr/fr.opf#epubcfi(/6/6)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../de/de.opf#epubcfi(/6/4)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../es/es.opf#epubcfi(/6/8)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../it/it.opf#epubcfi(/6/6)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                <span class="hljs-comment">&lt;!-- Chapter 3 --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../en/en.opf#epubcfi(/6/6)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../fr/fr.opf#epubcfi(/6/8)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../de/de.opf#epubcfi(/6/6)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../es/es.opf#epubcfi(/6/10)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span> = <span class="hljs-string">"../../it/it.opf#epubcfi(/6/8)"</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- …  could be even more fine grained for better results … --&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre>
					</aside>
				</section>

				<section id="rendition-mapping-container-id"><div class="header-wrapper"><h4 id="x5-4-4-container-identification"><bdi class="secno">5.4.4 </bdi>Container identification</h4><a class="self-link" href="#rendition-mapping-container-id" aria-label="Permalink for Section 5.4.4"></a></div>
					

					<p>The location of the <a data-link-type="dfn" href="#dfn-rendition-mapping-documents" class="internalDFN" id="ref-for-dfn-rendition-mapping-documents-7">rendition mapping document</a> is identified in the container document using
						a <a href="https://www.w3.org/TR/epub-33/#sec-container.xml-link-elem"><code>link</code> element</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>],
						where:</p>

					<ul>
						<li>the <code>href</code> attribute <em class="rfc2119">MUST</em> reference the location of the rendition mapping
							document relative to the root of the EPUB container;</li>
						<li>the <code>rel</code> attribute <em class="rfc2119">MUST</em> specify the value "<code>mapping</code>";</li>
						<li>the <code>media-type</code> attribute <em class="rfc2119">MUST</em> specify the value
								"<code>application/xhtml+xml</code>".</li>
					</ul>

					<p>The container document <em class="rfc2119">MUST NOT</em> reference more than one mapping document.</p>

					<aside class="example" id="example-9"><div class="marker">
    <a class="self-link" href="#example-9">Example<bdi> 9</bdi></a>
  </div>
						<p>The following example shows the <code>container.xml</code> file for a multilingual EPUB
							publication. The location of the rendition mapping document is included in the
								<code>link</code> element.</p>

						<pre aria-busy="false"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">container</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"urn:oasis:names:tc:opendocument:xmlns:container"</span>
           <span class="hljs-attr">xmlns:rendition</span>=<span class="hljs-string">"http://www.idpf.org/2013/rendition"</span>
           <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">rootfiles</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"en/en.opf"</span>
           <span class="hljs-attr">rendition:language</span>=<span class="hljs-string">"en"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span> /&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">rootfile</span> <span class="hljs-attr">full-path</span>=<span class="hljs-string">"de/de.opf"</span>
           <span class="hljs-attr">rendition:language</span>=<span class="hljs-string">"de"</span>
           <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/oebps-package+xml"</span> /&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-name">rootfiles</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">links</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"renditionMapping.html"</span>
             <span class="hljs-attr">rel</span>=<span class="hljs-string">"mapping"</span>
             <span class="hljs-attr">media-type</span>=<span class="hljs-string">"application/xhtml+xml"</span> /&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-name">links</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">container</span>&gt;</span></code></pre>
					</aside>
				</section>
			</section>

			<section id="rendition-mapping-proc-model" class="informative"><div class="header-wrapper"><h3 id="x5-5-processing-model"><bdi class="secno">5.5 </bdi>Processing model</h3><a class="self-link" href="#rendition-mapping-proc-model" aria-label="Permalink for Section 5.5"></a></div><p><em>This section is non-normative.</em></p>
				

				<p>This section provides a non-normative model by which the <a data-link-type="dfn" href="#dfn-rendition-mapping-documents" class="internalDFN" id="ref-for-dfn-rendition-mapping-documents-8">rendition mapping document</a> could be
					processed by a reading system. It does not address how or when a reading system should switch
					renditions. </p>

				<p>The desired outcome of the rendition mapping document's mapping capabilities is to display content in
					the new rendition that is equivalent to their location in the current rendition, so that a user
					maintains their place during reading. To accomplish this goal, a compliant reading system could
					follow these steps to reset the current rendition when a change condition is triggered:</p>

				<ul>
					<li>
						<p>First, it would ascertain the position range in the current rendition:</p>
						<ul>
							<li>For a fixed format rendition, this will most likely be the rectangle for the current
								viewport.<br></li>
							<li>For a reflowable rendition, this will most likely be the range of text currently shown
								on the screen.<br></li>
						</ul>
					</li>
				</ul>
				<ul>
					<li>Next, it would determine which rendition to navigate to, as defined in <a href="#rendition-selection-proc-model" class="sec-ref"><bdi class="secno">4.5 </bdi>Processing model</a>.</li>
					<li>
						<p>Finally, the reading system would parse the <code>ul</code> elements to find ones that
							contain <code>li</code> elements with child <code>a</code> elements that both specify the
							same rendition and intersect the current range:</p>
						<ul>
							<li>If there is one and only one such <code>ul</code> element, the reading system would
								navigate to the beginning of the range in the new rendition. </li>
							<li>If there is more than one such <code>ul</code> element, then the reading system behavior
								is undefined. The reading system might prompt the user to select between the new
								locations, or might choose between them using its own heuristics.<br></li>
							<li>If no matching <code>ul</code> elements are found, the reading system will have to
								determine the location to navigate to in the new rendition as if there was no rendition
								mapping document.</li>
						</ul>
					</li>
				</ul>

				<p>Note that what happens during navigation is largely a user experience issue, so a reading system
					might choose to consider additional information than above to try to achieve a better outcome.</p>
			</section>
		</section>
		<section id="app-schemas" class="appendix informative"><div class="header-wrapper"><h2 id="a-schemas"><bdi class="secno">A. </bdi>Schemas</h2><a class="self-link" href="#app-schemas" aria-label="Permalink for Appendix A."></a></div><p><em>This section is non-normative.</em></p>
			

			<p>Validation using the schemas in this appendix requires a processor that supports [<cite><a class="bibref" data-link-type="biblio" href="#bib-relaxng-schema" title="Information technology -- Document Schema Definition Language (DSDL) -- Part 2: Regular-grammar-based validation -- RELAX NG">relaxng-schema</a></cite>] and
				[<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">xmlschema11-2</a></cite>].</p>

			<section id="schema-metadata"><div class="header-wrapper"><h3 id="a-1-metadata-xml-schema"><bdi class="secno">A.1 </bdi>Metadata.xml Schema</h3><a class="self-link" href="#schema-metadata" aria-label="Permalink for Appendix A.1"></a></div>
				
				<p>The schema for including metadata in the <code>metadata.xml</code> file, as described in <a href="#pub-metadata" class="sec-ref"><bdi class="secno">3.2 </bdi>Publication metadata</a>, is available at <a href="https://github.com/w3c/epubcheck/blob/main/src/main/resources/com/adobe/epubcheck/schema/30/ocf-metadata-30.rnc">https://github.com/w3c/epubcheck/blob/main/src/main/resources/com/adobe/epubcheck/schema/30/ocf-metadata-30.rnc</a>.</p>
			</section>

			<section id="schema-container"><div class="header-wrapper"><h3 id="a-2-container-xml-schema"><bdi class="secno">A.2 </bdi>Container.xml schema</h3><a class="self-link" href="#schema-container" aria-label="Permalink for Appendix A.2"></a></div>
				
				<p>The schema for including rendition selection attributes in the <code class="markup">container.xml</code> file, as described in <a href="#rendition-selection" class="sec-ref"><bdi class="secno">4. </bdi>Rendition selection</a>, is available at
						<a href="https://github.com/w3c/epubcheck/blob/main/src/main/resources/com/adobe/epubcheck/schema/30/multiple-renditions/container.rnc">https://github.com/w3c/epubcheck/blob/main/src/main/resources/com/adobe/epubcheck/schema/30/multiple-renditions/container.rnc</a>.</p>
			</section>

			<section id="schema-mapping-doc"><div class="header-wrapper"><h3 id="a-3-mapping-document-schema"><bdi class="secno">A.3 </bdi>Mapping document schema</h3><a class="self-link" href="#schema-mapping-doc" aria-label="Permalink for Appendix A.3"></a></div>
				
				<p>The schema for Mapping Documents, as described in <a href="#rendition-mapping" class="sec-ref"><bdi class="secno">5. </bdi>Rendition mapping</a>, is available at
						<a href="https://github.com/w3c/epubcheck/blob/main/src/main/resources/com/adobe/epubcheck/schema/30/multiple-renditions/mapping.rnc">https://github.com/w3c/epubcheck/blob/main/src/main/resources/com/adobe/epubcheck/schema/30/multiple-renditions/mapping.rnc</a>.</p>
			</section>
		</section>
		<section id="change-log" class="appendix informative"><div class="header-wrapper"><h2 id="b-change-log"><bdi class="secno">B. </bdi>Change log</h2><a class="self-link" href="#change-log" aria-label="Permalink for Appendix B."></a></div><p><em>This section is non-normative.</em></p>
			

			<p>Note that this change log only identifies substantive changes since <a href="http://idpf.org/epub/renditions/multiple/">EPUB Multiple-Rendition Publications 1.0</a>
				— those that affect the conformance of <a data-link-type="dfn" data-type="dfn" href="https://www.w3.org/TR/epub-33/#dfn-epub-publication">EPUB publications</a> or are similarly noteworthy.</p>

			<p>For a list of all issues addressed during the revision, refer to the <a href="https://github.com/w3c/epub-specs/issues?q=is%3Aissue+is%3Aclosed+label%3AMultipleRenditions11">working group's issue tracker</a>.</p>

			<ul>
				<li>19-Mar-2021: Require the use of the unique identifier in the <code>metadata.xml</code> file for
					obfuscating resources and recommend it be the same as the identifier in the default rendition. See
						<a href="https://github.com/w3c/publ-epub-revision/issues/1443">issue 1443</a>.</li>
				<li>19-Mar-2021: Added note clarifying that package documents need to be in a common directory to share
					resources. See <a href="https://github.com/w3c/publ-epub-revision/issues/619">issue 619</a>.</li>
				<li>19-Mar-2021: Fixed incorrect reference to <code>link</code> element being a child of the
						<code>container</code> element. See <a href="https://github.com/w3c/publ-epub-revision/issues/584">issue 584</a>.</li>
				<li>24-Dec-2020: The specification no longer makes reference to a release identifier, but the
					requirement to include a unique identifier and last modification date in the
						<code>metadata.xml</code> file remain for backwards compatibility. See <a href="https://github.com/w3c/publ-epub-revision/issues/1440">issue 1440</a>.</li>
				<li>16-Dec-2020: Terminology and requirements related to renditions of an EPUB publication have been
					moved to this specification to simplify readability of both this and the [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">epub-33</a></cite>] specification.
					These changes do not affect the ability to include multiple renditions in an EPUB publication. See
						<a href="https://github.com/w3c/publ-epub-revision/issues/1436">issue 1436</a>.</li>
			</ul>
		</section>
		<section id="ack" class="appendix informative"><div class="header-wrapper"><h2 id="c-acknowledgements"><bdi class="secno">C. </bdi>Acknowledgements</h2><a class="self-link" href="#ack" aria-label="Permalink for Appendix C."></a></div><p><em>This section is non-normative.</em></p>
    

    <p>The following members of the EPUB 3 Working Group contributed to the development of this specification:</p>

    <ul class="ack">
                <li>Will AWAD (Newgen Knowledgeworks)</li>
        <li>Sofia Bautista (Legible Media Inc.)</li>
        <li>Laura Brady (Legible Media Inc.)</li>
        <li>Leah Brochu (National Network for Equitable Library Service)</li>
        <li>Matthew C. Chan (House of Anansi Press)</li>
        <li>Yu-Wei Chang (Taiwan Digital Publishing Forum)</li>
        <li>Fred Chasen (Scribd)</li>
        <li>Juan Corona (Legible Media Inc.)</li>
        <li>Dave Cramer (<abbr title="World Wide Web Consortium">W3C</abbr> Invited Expert, chair)</li>
        <li>Romain Deltour (DAISY Consortium)</li>
        <li>Marisa DeMeglio (DAISY Consortium)</li>
        <li>Brady Duga (Google LLC)</li>
        <li>Reinaldo Ferraz (NIC.br - Brazilian Network Information Center)</li>
        <li>John Foliot (<abbr title="World Wide Web Consortium">W3C</abbr> Invited Expert)</li>
        <li>Teenya Franklin (Pearson plc)</li>
        <li>Hadrien Gardeur (EDRLab)</li>
        <li>Matt Garrish (DAISY Consortium)</li>
        <li>Jen Goulden (Crawford Technologies)</li>
        <li>Ivan Herman (<abbr title="World Wide Web Consortium">W3C</abbr>, staff contact)</li>
        <li>Tetsu Hoshino (Kodansha, Publishers, Ltd.)</li>
        <li>Norikazu Ishizu (Kadokawa Corporation)</li>
        <li>Norihito IYENAGA (Kodansha, Publishers, Ltd.)</li>
        <li>Rick Johnson (VitalSource Technologies)</li>
        <li>Ken Jones (Circular Software)</li>
        <li>Antonio Kamiya (Dentsu Group Inc.)</li>
        <li>Deborah Kaplan (<abbr title="World Wide Web Consortium">W3C</abbr> Invited Expert)</li>
        <li>Bill Kasdorf (Book Industry Study Group)</li>
        <li>George Kerscher (DAISY Consortium)</li>
        <li>Kazuhito Kidachi (Mitsue-Links Co., Ltd.)</li>
        <li>Masakazu Kitahara (Voyager Japan, Inc.)</li>
        <li>Toshiaki Koike (Voyager Japan, Inc.)</li>
        <li>Ryo Kuroda (ACCESS CO., LTD.)</li>
        <li>Charles LaPierre (Benetech)</li>
        <li>Dan Lazin (Google LLC)</li>
        <li>Laurent Le Meur (EDRLab)</li>
        <li>Victoria Lee (Apple, Inc.)</li>
        <li>Farrah Little (National Network for Equitable Library Service)</li>
        <li>Victor Lopes (Apple, Inc.)</li>
        <li>Karan  Malhotra (Newgen Knowledgeworks)</li>
        <li>Makoto Murata (DAISY Consortium)</li>
        <li>Cristina Mussinelli (Fondazione LIA)</li>
        <li>Yoichiro Nagao (Kodansha, Publishers, Ltd.)</li>
        <li>Theresa O'Connor (Apple, Inc.)</li>
        <li>Yoshinori Ohmura (SHUEISHA Inc.)</li>
        <li>Rachel Osolen (National Network for Equitable Library Service)</li>
        <li>Gregorio Pellegrino (Fondazione LIA)</li>
        <li>Vijaya Gowri Perumal (Newgen Knowledgeworks)</li>
        <li>Wendy Reid (Rakuten Group, Inc., chair)</li>
        <li>John Roque (Apple, Inc.)</li>
        <li>Leonard Rosenthol (Adobe)</li>
        <li>Shinobu Sato (Kadokawa Corporation)</li>
        <li>Ben Schroeter (Pearson plc)</li>
        <li>Daihei Shiohama (MEDIA DO Co., Ltd.)</li>
        <li>Tzviya Siegman (Wiley)</li>
        <li>Avneesh Singh (DAISY Consortium)</li>
        <li>MOTOI SUZUKI (SHUEISHA Inc.)</li>
        <li>Yutaka Suzuki (Kadokawa Corporation)</li>
        <li>Kyrce Swenson (Pearson plc)</li>
        <li>Shinya Takami (Kadokawa Corporation, chair)</li>
        <li>Mateus Teixeira (W. W. Norton &amp; Company)</li>
        <li>Yukio Tomikura (Kodansha, Publishers, Ltd.)</li>
        <li>Aimee Ubbink (Crawford Technologies)</li>
        <li>Daniel Weck (DAISY Consortium)</li>
        <li>Zheng Xu (Gardenia Corp)</li>
        <li>Fuqiao Xue (<abbr title="World Wide Web Consortium">W3C</abbr>)</li>
        <li>Evan Yamanishi (W. W. Norton &amp; Company)</li>
        <li>Osamu Yoshiba (Kodansha, Publishers, Ltd.)</li>
        <li>Junichi Yoshii (Kodansha, Publishers, Ltd.)</li>
        <li>Naomi Yoshizawa (<abbr title="World Wide Web Consortium">W3C</abbr>)</li>
        <li>Laurence Zaysser (EDRLab)</li>
    </ul>
    
</section>


	

<section id="references" class="appendix"><div class="header-wrapper"><h2 id="d-references"><bdi class="secno">D. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix D."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="d-1-normative-references"><bdi class="secno">D.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix D.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-dcterms">[dcterms]</dt><dd>
      <a href="https://www.dublincore.org/specifications/dublin-core/dcmi-terms/"><cite>DCMI Metadata Terms</cite></a>. DCMI Usage Board.  DCMI. 20 January 2020. DCMI Recommendation. URL: <a href="https://www.dublincore.org/specifications/dublin-core/dcmi-terms/">https://www.dublincore.org/specifications/dublin-core/dcmi-terms/</a>
    </dd><dt id="bib-epub-33">[epub-33]</dt><dd>
      <a href="https://www.w3.org/TR/epub-33/"><cite>EPUB 3.3</cite></a>. Matt Garrish; Ivan Herman; Dave Cramer.  W3C. 3 October 2022. W3C Candidate Recommendation. URL: <a href="https://www.w3.org/TR/epub-33/">https://www.w3.org/TR/epub-33/</a>
    </dd><dt id="bib-epubcfi-11">[epubcfi-11]</dt><dd>
      <a href="http://idpf.org/epub/linking/cfi/epub-cfi-20170105.html"><cite>EPUB Canonical Fragment Identifiers 1.1</cite></a>. Peter Sorotokin; Garth Conboy; Brady Duga; John Rivlin; Don Beaver; Kevin Ballard; Alastair Fettes; Daniel Weck.  IDPF. 5 October 2017. URL: <a href="http://idpf.org/epub/linking/cfi/epub-cfi-20170105.html">http://idpf.org/epub/linking/cfi/epub-cfi-20170105.html</a>
    </dd><dt id="bib-html">[html]</dt><dd>
      <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Anne van Kesteren; Domenic Denicola; Ian Hickson; Philip Jägenstedt; Simon Pieters.  WHATWG. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
    </dd><dt id="bib-iso24751-3">[iso24751-3]</dt><dd>
      <a href="http://www.iso.org/iso/catalogue_detail?csnumber=43604"><cite> ISO/IEC 24751-3:2008 Information technology -- Individualized adaptability and accessibility in e-learning, education and training -- Part 3: "Access for all" digital resource description</cite></a>. 2008-10-01. URL: <a href="http://www.iso.org/iso/catalogue_detail?csnumber=43604">http://www.iso.org/iso/catalogue_detail?csnumber=43604</a>
    </dd><dt id="bib-mediaqueries">[mediaqueries]</dt><dd>
      <a href="https://www.w3.org/TR/mediaqueries-4/"><cite>Media Queries Level 4</cite></a>. Florian Rivoal; Tab Atkins Jr..  W3C. 25 December 2021. W3C Candidate Recommendation. URL: <a href="https://www.w3.org/TR/mediaqueries-4/">https://www.w3.org/TR/mediaqueries-4/</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc4647">[rfc4647]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc4647"><cite>Matching of Language Tags</cite></a>. A. Phillips, Ed.; M. Davis, Ed..  IETF. September 2006. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc4647">https://www.rfc-editor.org/rfc/rfc4647</a>
    </dd><dt id="bib-rfc5646">[rfc5646]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc5646"><cite>Tags for Identifying Languages</cite></a>. A. Phillips, Ed.; M. Davis, Ed..  IETF. September 2009. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc5646">https://www.rfc-editor.org/rfc/rfc5646</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="d-2-informative-references"><bdi class="secno">D.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix D.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-relaxng-schema">[relaxng-schema]</dt><dd>
      <a href="http://standards.iso.org/ittf/PubliclyAvailableStandards/c052348_ISO_IEC_19757-2_2008(E).zip"><cite>Information technology -- Document Schema Definition Language (DSDL) -- Part 2: Regular-grammar-based validation -- RELAX NG</cite></a>.  ISO/IEC. 2008. URL: <a href="http://standards.iso.org/ittf/PubliclyAvailableStandards/c052348_ISO_IEC_19757-2_2008(E).zip">http://standards.iso.org/ittf/PubliclyAvailableStandards/c052348_ISO_IEC_19757-2_2008(E).zip</a>
    </dd><dt id="bib-xmlschema11-2">[xmlschema11-2]</dt><dd>
      <a href="https://www.w3.org/TR/xmlschema11-2/"><cite>W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes</cite></a>. David Peterson; Sandy Gao; Ashok Malhotra; Michael Sperberg-McQueen; Henry Thompson; Paul V. Biron et al.  W3C. 5 April 2012. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xmlschema11-2/">https://www.w3.org/TR/xmlschema11-2/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-container-document" aria-label="Links in this document to definition: container document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-container-document" aria-label="Permalink for definition: container document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-container-document-1" title="§ 1.1 Overview">§ 1.1 Overview</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-default-rendition" aria-label="Links in this document to definition: default rendition">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-default-rendition" aria-label="Permalink for definition: default rendition. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-default-rendition-1" title="§ 1.2 Background">§ 1.2 Background</a> 
  </li><li>
    <a href="#ref-for-dfn-default-rendition-2" title="§ 2. Specifying multiple renditions">§ 2. Specifying multiple renditions</a> 
  </li><li>
    <a href="#ref-for-dfn-default-rendition-3" title="§ 3.2.1 The metadata.xml file">§ 3.2.1 The metadata.xml file</a> 
  </li><li>
    <a href="#ref-for-dfn-default-rendition-4" title="§ 3.2.1.1 Resource obfuscation">§ 3.2.1.1 Resource obfuscation</a> 
  </li><li>
    <a href="#ref-for-dfn-default-rendition-5" title="§ 4.2 Content conformance">§ 4.2 Content conformance</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-multiple-rendition-publications" aria-label="Links in this document to definition: multiple-rendition publication">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-multiple-rendition-publications" aria-label="Permalink for definition: multiple-rendition publication. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-multiple-rendition-publications-1" title="§ 1.3 Relationship to EPUB 3">§ 1.3 Relationship to EPUB 3</a> 
  </li><li>
    <a href="#ref-for-dfn-multiple-rendition-publications-2" title="§ 3.2.1 The metadata.xml file">§ 3.2.1 The metadata.xml file</a> 
  </li><li>
    <a href="#ref-for-dfn-multiple-rendition-publications-3" title="§ 3.2.1.1 Resource obfuscation">§ 3.2.1.1 Resource obfuscation</a> 
  </li><li>
    <a href="#ref-for-dfn-multiple-rendition-publications-4" title="§ 5.1 Introduction">§ 5.1 Introduction</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-rendition" aria-label="Links in this document to definition: rendition">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-rendition" aria-label="Permalink for definition: rendition. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-rendition-1" title="§ 1.1 Overview">§ 1.1 Overview</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-2" title="§ 1.2 Background">§ 1.2 Background</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-3" title="§ 1.3 Relationship to EPUB 3">§ 1.3 Relationship to EPUB 3</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-4" title="§ 1.4 Terminology">§ 1.4 Terminology</a> <a href="#ref-for-dfn-rendition-5" title="Reference 2">(2)</a> <a href="#ref-for-dfn-rendition-6" title="Reference 3">(3)</a> <a href="#ref-for-dfn-rendition-7" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-8" title="§ 3.2.1 The metadata.xml file">§ 3.2.1 The metadata.xml file</a> <a href="#ref-for-dfn-rendition-9" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-10" title="§ 4.1 Introduction">§ 4.1 Introduction</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-11" title="§ 4.4.1 The rendition:media attribute">§ 4.4.1 The rendition:media attribute</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-12" title="§ 4.4.2 The rendition:layout attribute">§ 4.4.2 The rendition:layout attribute</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-13" title="§ 4.4.3 The rendition:language attribute">§ 4.4.3 The rendition:language attribute</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-14" title="§ 4.4.4 The rendition:accessMode attribute">§ 4.4.4 The rendition:accessMode attribute</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-15" title="§ 4.4.5 The rendition:label attribute">§ 4.4.5 The rendition:label attribute</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-16" title="§ 4.5 Processing model">§ 4.5 Processing model</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-17" title="§ 5.1 Introduction">§ 5.1 Introduction</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-rendition-mapping-documents" aria-label="Links in this document to definition: rendition mapping document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-rendition-mapping-documents" aria-label="Permalink for definition: rendition mapping document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-rendition-mapping-documents-1" title="§ 5.1 Introduction">§ 5.1 Introduction</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-mapping-documents-2" title="§ 5.2 Content conformance">§ 5.2 Content conformance</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-mapping-documents-3" title="§ 5.3 reading system conformance">§ 5.3 reading system conformance</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-mapping-documents-4" title="§ 5.4.1 XHTML content document: restrictions">§ 5.4.1 XHTML content document: restrictions</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-mapping-documents-5" title="§ 5.4.2 The nav element: modifications and restrictions">§ 5.4.2 The nav element: modifications and restrictions</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-mapping-documents-6" title="§ 5.4.3 Rendition mappings">§ 5.4.3 Rendition mappings</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-mapping-documents-7" title="§ 5.4.4 Container identification">§ 5.4.4 Container identification</a> 
  </li><li>
    <a href="#ref-for-dfn-rendition-mapping-documents-8" title="§ 5.5 Processing model">§ 5.5 Processing model</a> 
  </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>